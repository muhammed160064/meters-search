
<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆÙ‚Ø¹ Ø¹Ø¯Ø§Ø¯ - Google Sheet</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            background: #f9f9f9;
            padding: 40px;
        }
        input {
            width: 300px;
            padding: 10px;
            font-size: 16px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
        }
        #result {
            margin-top: 20px;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 5px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

<h2>ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆÙ‚Ø¹ Ø¹Ø¯Ø§Ø¯ Ù…Ù† Google Sheets</h2>
<p>Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ØµÙ†Ø¹ÙŠ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨:</p>
<input type="text" id="searchInput" placeholder="Ù…Ø«Ø§Ù„: LYE1820300388711 Ø£Ùˆ 4310851998 Ø£Ùˆ 30006217564">
<button onclick="search()">Ø¨Ø­Ø«</button>

<div id="result"></div>

<script>
    let meterData = [];

    window.onload = function() {
        Tabletop.init({
            key: '1zG3ByEpRiklWhm94vr5h-SYYjNwgnmSv',
            simpleSheet: true,
            callback: function(data) {
                meterData = data;
            }
        });
    }

    function search() {
        const query = document.getElementById("searchInput").value.trim();
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = "";

        if (!query) {
            resultDiv.innerHTML = "<p>ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù….</p>";
            return;
        }

        const match = meterData.find(item =>
            item["Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ØµÙ†Ø¹ÙŠ"] === query ||
            item["Ø±Ù‚Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"] === query ||
            item["Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨"] === query ||
            item["Ø±Ù‚Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"] === query.toString() ||
            item["Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨"] === query.toString()
        );

        if (match) {
            resultDiv.innerHTML = `
                <h3>ğŸ“ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¯Ø§Ø¯:</h3>
                <p><strong>Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨:</strong> ${match["Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨"] || "ØºÙŠØ± Ù…ØªÙˆÙØ±"}</p>
                <p><strong>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ØµÙ†Ø¹ÙŠ:</strong> ${match["Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ØµÙ†Ø¹ÙŠ"]}</p>
                <p><strong>Ø±Ù‚Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ:</strong> ${match["Ø±Ù‚Ù… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ"]}</p>
                <p><strong>Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶:</strong> ${match["Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶"]}</p>
                <p><strong>Ø®Ø· Ø§Ù„Ø·ÙˆÙ„:</strong> ${match["Ø®Ø· Ø§Ù„Ø·ÙˆÙ„"]}</p>
                <p><a href="${match["Ø±Ø§Ø¨Ø· Google Maps"]}" target="_blank">ğŸ“ Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Google Maps</a></p>
            `;
        } else {
            resultDiv.innerHTML = "<p>âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¯Ø§Ø¯.</p>";
        }
    }
</script>

</body>
</html>
